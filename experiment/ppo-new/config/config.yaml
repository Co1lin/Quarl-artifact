mode: train
resume: False
ckpt_path: outputs/2022-05-10/13-29-42/last.ckpt

gpus: [2,3]
# num_workers: 8

seed: 98765
wandb:
  en: True
  offline: False
  entity: quartz

# multiprocessing
mp_start_method: spawn # fork
obs_per_agent: 3 # 128

# quartz
input_graphs:
  - name: 'barenco_tof_3'
    path: '../barenco_tof_3_opt_path/subst_history_39.qasm'
  # - name: 'barenco_tof_3'
  #   path: '../barenco_tof_3_opt_path/subst_history_39.qasm'

gate_set: ['h', 'cx', 't', 'tdg']
ecc_file: 'bfs_verified_simplified.json'
no_increase: False
include_nop: True

# exp collection
nop_stop: True
num_trajs_per_iter: 9
batch_inference: True
len_episode: 300
invalid_reward: -1.0
max_gate_count_ratio: 1.2

# network
graph_embed_size: 128
actor_hidden_size: 256
critic_hidden_size: 128

# algorithm
gamma: 0.95
entropy_coeff: 0.02
eps_clip: 0.2
softmax_hit_rate: 0.8

# training
max_iterations: 1e8
mini_batch_size: 3072 # per DDP process
k_epochs: 20 # TODO
lr_graph_embedding: 3e-4
lr_actor: 3e-4
lr_critic: 1e-3
update_policy_interval: 20
save_ckpt_interval: 10
